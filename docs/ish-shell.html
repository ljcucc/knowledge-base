<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="iSH Shell">

  <meta property="og:site_name" content="wwwiki - ljcu.cc">
  <meta property="og:title" content="iSH Shell" />
  <meta property="og:description" content="" />
  <meta property="og:image" itemprop="image" content="./assets/default-header.png">
  <meta property="og:type" content="website" />

  <title>iSH Shell</title>
  <link rel="stylesheet" href="style.css">

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
  <div class="toc">
      </div>

  <div class="body">
    <div class="topbar">
      <a class="title" href="index.html">wwwiki - ljcu.cc</a>
    </div>
  
    <div class="content">
            <img class="header-img" src="assets/default-header.png" alt="default header" />
      <h1 class="title">iSH Shell</h1>
        
  
      <p>iSH is a Linux-like shell on iOS and iPadOS</p>
      <h1 id="install-dwm-and-vnc">Install DWM and VNC</h1>
      <blockquote>
      <p>Reference from the offical wiki: <a
      href="https://github.com/ish-app/ish/wiki/Running-a-VNC-Server"
      class="uri">https://github.com/ish-app/ish/wiki/Running-a-VNC-Server</a></p>
      </blockquote>
      <p>install dependencies:</p>
      <div class="sourceCode" id="cb1"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apk</span> add x11vnc x11vnc-doc xvfb xterm xorg-server xf86-video-dummy </span></code></pre></div>
      <p>tools and dependencies for compiling DWM:</p>
      <div class="sourceCode" id="cb2"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apk</span> add gcc make libx11-dev libxft-dev </span></code></pre></div>
      <p>clone dwm:</p>
      <div class="sourceCode" id="cb3"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://git.suckless.org/dwm</span></code></pre></div>
      <blockquote>
      <p>ref from the issue <a
      href="https://github.com/ish-app/ish/issues/1640">1640</a>, if you
      stuck on resolving while you clone, try stop it and run
      <code>git config --global pack.threads "1"</code> then try to
      clone again.</p>
      </blockquote>
      <p>Disable xinerama in <code>config.mk</code> since dwm will only
      run in a virtual headless monitor of VNC.</p>
      <p>then compile it:</p>
      <pre><code>make install</code></pre>
      <blockquote>
      <p>compile may takes some times, on iPad Air 4 takes about less
      than 1 min.</p>
      </blockquote>
      <p>then setup scripts and configs for vnc server:</p>
      <div class="sourceCode" id="cb5"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-e</span> /etc/X11/xorg.conf.d <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mkdir</span> <span class="at">-p</span> /etc/X11/xorg.conf.d <span class="co"># If it doesn&#39;t exist, create it.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
      <p>headless xorg monitor config:</p>
      <pre><code>cat &lt;&lt;HERE &gt; /etc/X11/xorg.conf.d/10-headless.conf
Section &quot;Monitor&quot;
        Identifier &quot;dummy_monitor&quot;
        HorizSync 28.0-80.0
        VertRefresh 48.0-75.0
        DisplaySize  250 174    # In millimeters, iPad gen 7 &amp; 8
EndSection

Section &quot;Device&quot;
        Identifier &quot;dummy_card&quot;
        VideoRam 256000
        Driver &quot;dummy&quot;
EndSection

Section &quot;Screen&quot;
        Identifier &quot;dummy_screen&quot;
        Device &quot;dummy_card&quot;
        Monitor &quot;dummy_monitor&quot;
        SubSection &quot;Display&quot;
           depth 24
           Modes &quot;1024x768&quot;  # Works OK on ~10 inch iPad&#39;s
 #          Modes &quot;1280x1024&quot;  # Likely to work on larger iPad
        EndSubSection
EndSection
HERE</code></pre>
      <p>create xinitrc:</p>
      <div class="sourceCode" id="cb7"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&lt;&lt;THERE</span> <span class="op">&gt;</span> /root/.xinitrc</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="st">xrdb -merge ~/.Xresources</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">xterm -geometry 80x50+494+51 &amp;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">xterm -geometry 80x20+494-0 &amp;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">exec dwm</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="op">THERE</span></span></code></pre></div>
      <p>Create .Xresources file: (if your using xterm, but Iâ€™m using
      st)</p>
      <pre><code>cat &lt;&lt;EVERYWHERE &gt; /root/.Xresources
Xft.dpi: 264
xterm*VT100.Translations: #override \
    Ctrl &lt;Key&gt; minus: smaller-vt-font() \n\
    Ctrl &lt;Key&gt; plus: larger-vt-font() \n\
    Ctrl &lt;Key&gt; 0: set-vt-font(d)
EVERYWHERE</code></pre>
      <p>then create a script to start vnc server:</p>
      <div class="sourceCode" id="cb9"><pre
      class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/ash</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stupidly simple script to start vnc.  </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="va">CHECK</span><span class="op">=</span><span class="kw">`</span><span class="fu">ps</span> <span class="at">-o</span> args <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;{startx} /bin/sh /usr/bin/startx&quot;</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="kw">`</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Only run once.  The grep causes CHECK to equal 1</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$CHECK</span> <span class="ot">-eq</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span> <span class="co"># Nothing running, clear stale locks</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span> <span class="at">-rf</span> /tmp/.X<span class="pp">*</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>   <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$0</span><span class="st"> is already running.  We&#39;re done here.&quot;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   <span class="bu">exit</span> 1</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># See if location services are running already.  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Having them running reduces the odds of iSH getting</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># killed while in the background.</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="va">CHECK</span><span class="op">=</span><span class="kw">`</span><span class="fu">ps</span> <span class="at">-o</span> args <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;cat /dev/location&quot;</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="kw">`</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Only run once.  The grep causes CHECK to equal 1</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$CHECK</span> <span class="ot">-eq</span> 1 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cat</span> /dev/location <span class="op">&gt;</span> /dev/null <span class="kw">&amp;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="ex">startx</span> <span class="kw">&amp;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="ex">x11vnc</span> <span class="at">-display</span> :0 <span class="at">-noshm</span> <span class="at">-forever</span> <span class="kw">&amp;</span> </span></code></pre></div>
    </div>
  </div>
    <!-- image display dialog -->
  <dialog modal-mode="mega">
    <img id="disp-img" src="" alt="">
    <form method="dialog">
      <button class="menu-button" value="cancel">
        <i class="material-icons">close</i>
      </button>
    </form>
  </dialog>
  
</body>
<script>
  window.addEventListener("load", e=>{
    document.querySelectorAll("img").forEach(item => item.addEventListener("click", e => {
      console.log();
      let dialog = document.querySelector("dialog");
      document.querySelector("#disp-img").setAttribute("src", e.srcElement.getAttribute("src"));
      dialog.showModal();
    }));
  });
</script>

</html>